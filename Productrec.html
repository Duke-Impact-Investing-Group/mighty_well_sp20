<!-- Note from Aneesh:  -->
<!-- Right now printing to Console (Ctrl-F console.log) -->
<!-- Can change this to instead print on a screen/store easily -->

<form id="survey-form" action="">
  <div id = "container">
  <h1 id="title">Product Finder</h1>
  <p id="description">Answer the 4 questions below, and we will recommend a Mighty Well Product and blog posts that best suit your needs.</p>

  <!-- ------------------Gender---------------------------- -->
  <div class = "tab">
    <h3 class= "number"> - 1 - </h3>
    <h2 class = "question"> What is your gender? </h2><br>
    <p>
        <input type="radio" name="gender" value="male" >Male<br>
        <input type="radio" name="gender" value="female">Female<br>
        <input type="radio" name="gender" value="other">Other
      </p>
  </div>

    <!-- ------------------Medical Condition-------------------------------- -->
  <div class = "tab">
      <h3 class = "number"> - 2 - </h3>
      <h2 class = "question"> Select all that apply to you! </h2> <br>
      <label class = "checkbox-label">
        <span class = "checkbox-custom">
          <ul>
         <li><input type="checkbox" name="medcon" value="aplasticAnemia">Aplastic Anemia<br></li>
         <li><input type="checkbox" name="medcon" value="behcets">Behcet's Syndrome<br></li>
         <li><input type="checkbox" name="medcon" value="caps">CAPS<br></li>
          <li><input type="checkbox" name="medcon" value="cysticFibrosis" >Cystic Fibrosis<br></li>
          <li><input type="checkbox" name="medcon" value="diabetes" >Diabetes<br></li>
          <li><input type="checkbox" name="medcon" value="dysautonomia">Dysautonomia<br></li>
          <li><input type="checkbox" name="medcon" value="eds">Ehlers-Danlos Syndrome (EDS)<br></li>
          <li><input type="checkbox" name="medcon" value="fibromyalgia">Fibromyalgia<br></li>
          <li><input type="checkbox" name="medcon" value="gp" >Gastroparesis (GP)<br></li>
          <li><input type="checkbox" name="medcon" value="hrt" >HRT<br></li>
          <li><input type="checkbox" name="medcon" value="lyme" >Lyme Disease<br></li>
          <li><input type="checkbox" name="medcon" value="marfan" >Marfan Syndrome<br></li>
          <li><input type="checkbox" name="medcon" value="mcas" >MCAS<br></li>
          <li><input type="checkbox" name="medcon" value="osteomyelitis">Osteomyelitis<br></li>
          <li><input type="checkbox" name="medcon" value="partialEmptySella">Partial Empty Sella<br></li>
          <li><input type="checkbox" name="medcon" value="polyarthralgia">Polyarthralgia<br></li>
          <li><input type="checkbox" name="medcon" value="pcos" >Polycystic Ovary Syndrome (PCOS)<br></li>
          <li><input type="checkbox" name="medcon" value="pots" >Postural Orthostatic Tachycardia Syndrome (POTS)<br></li>
          <li><input type="checkbox" name="medcon" value="thyroidcancer" >Thyroid Cancer<br></li>
          <li><input type="checkbox" name="medcon" value="uc" >Ulcerative Colitis (UC)<br></li>
          <li><input type="checkbox" name="medcon" value="other" >Other<br></li>
          </ul>
        </span>
        </label>
  </div>
  <!-- ------------------Medical Devices-------------------------------- -->
  <div class="tab">
      <h3 class="number"> - 3 - </h3>
      <h2 class="question"> What medical devices do you use?</h2><br>
      <label class = "checkbox-label">
      <span class="checkbox-custom">
      <p>
          <!--<input type="checkbox" name="meddev" value="diabeticPumps">Diabetic Pumps<br>-->
          <input type="checkbox" name="meddev" value="EpiPen">EpiPen (Allergies) <br>
          <input type="checkbox" name="meddev" value="glucoseMonitor">Diabetic Supplies<br>
         <!--input <input type="checkbox" name="meddev" value="hickmanLines">Hickman Lines (CVCs)<br> -->
         <!-- <input type="checkbox" name="meddev" value="inhalers">Inhalers<br> -->
          <input type="checkbox" name="meddev" value="mastectomyDrains">Mastectomy Drains<br>
          <input type="checkbox" name="meddev" value="midlines">Midlines<br>
          <input type="checkbox" name="meddev" value="peripherals">Peripheral I.V.s<br>
          <input type="checkbox" name="meddev" value="PICCLines">PICC Lines<br>
          <input type="checkbox" name="meddev" value="pillsAndOtherMedications">Pills and Other Medications<br>
          <input type="checkbox" name="meddev" value="ports">Port<br>
          <!-- <input type="checkbox" name="meddev" value="vitamins">Vitamins<br> -->
          <input type="checkbox" name="meddev" value="wheelchairs">Wheelchairs/Mobility Aids<br>
          <input type="checkbox" name="meddev" value="other">Other<br>
      </p>
      </span>
      </label>
  </div>

  <!-- -----------------Use Case--------------------------------- -->

  <div class="tab">
      <h3 class="number"> - 4 - </h3>
      <h2 class="question"> What are you looking to use Mighty Well products for? </h2><br>
      <label class = "checkbox-label">
      <span class="checkbox-custom">
      <p>
          <input type="checkbox" name="usecase" value="antibioticInfusion">Antibiotic Infusion<br>
          <input type="checkbox" name="usecase" value="chemotherapy">Chemotherapy<br>
          <input type="checkbox" name="usecase" value="glucoseMonitoring">Glucose Monitoring<br>
          <input type="checkbox" name="usecase" value="holdMedicalSupplies">Hold Medical Supplies/Items<br>
          <input type="checkbox" name="usecase" value="IVInfusion">IV Infusion<br>
          <input type="checkbox" name="usecase" value="lookingGood">Looking Good/Feeling Proud!<br>
          <input type="checkbox" name="usecase" value="organizeMedications">Organize Medications<br>
          <input type="checkbox" name="usecase" value="raisingAwareness">Raising Awareness<br>
          <input type="checkbox" name="usecase" value="salineTreatment">Saline Treatment<br>
          <input type="checkbox" name="usecase" value="subcutaneousInjection">Subcutaneous Injection<br>
          <input type="checkbox" name="usecase" value="TPNInjection">TPN Injection<br>
          <input type="checkbox" name="usecase" value="transfusion">Transfusion<br>
          <input type="checkbox" name="usecase" value="tubeFeeding">Tube Feeding<br>
          <input type="checkbox" name="usecase" value="other">Other<br>
      </p>
      </span>
      </label>
  </div>

  <div class="tab" id="productRecContainer">
    <h1>Your Results!</h1>
    <h3>Enjoy these Mighty Well products and specially curated blog posts just for you!</h3>
    <a href="" class = "productLink">
    <h2 id="productName" style="float: left;"> Product Name </h2><br>
    <img src="https://bit.ly/2SEVDwz" id= "productPicture" alt = "Product Picture">
    </a>

    <a href = "" class="blogLink">
    <h2 id="blogName" style="float: right;"></h2><br>
    <img src="" id="blogPicture" alt = "blog Picture" style="float: right;">
    </a>

  </div>

  <div style="overflow:auto;">
      <div style = "float:left;"></div>
          <p id="demo"></p>
          <div class = "center">
          <button type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
          <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
      </div>
  </div>
  <!-- Circles which indicates the steps of the form: -->
  <div style="text-align:center;margin-top:40px;">
      <span class="step"></span>
      <span class="step"></span>
      <span class="step"></span>
      <span class="step"></span>
  </div>
</div>

  <style>
        ul {
        columns: 300px;
        list-style: none; 
      }

      #regForm {
          background-color: #ffffff;
          margin: 100px auto;
          padding: 40px;
          width: 70%;
          min-width: 300px;
      }
      #container{
        background-color:#edf9fc;
        padding:100px;
      }

      #productRecContainer{
        background-color:#ffffff;
        padding:100px;
      }

      #productPicture{
        padding: 20px;
        max-width: 40%;
        height: auto;
      }

      .center{
        text-align-last: center;
      }

      ul.checkbox  {
        margin: 0;
        padding: 0;
        margin-left: 20px;
        list-style: none;
        }

    ul.checkbox li input {
    margin-right: .25em;
    }

    ul.checkbox li {
    border: 1px transparent solid;
    float: left;
    min-width: 400px;
    }

      .description {
          text-align: center;
          width: 75%;

      }

      .number {
          text-align: center;
      }

      .question{
          text-align: center;
          padding:10px
      }


      button{
         text-align: center;
      }

      /* Style the input fields */
      input {
          text-align: center;
          padding: 10px;
          width: 100%;
          font-size: 17px;
          font-family: Raleway;
          border: 1px solid #aaaaaa;
      }

      /* Mark input boxes that gets an error on validation: */
      input.invalid {
          background-color: #ffdddd;
      }

      /* Hide all steps by default: */
      .tab {
          display: none;
      }

      /* Make circles that indicate the steps of the form: */
      .step {
          height: 15px;
          width: 15px;
          margin: 0 2px;
          background-color: #bbbbbb;
          border: none;
          border-radius: 50%;
          display: inline-block;
          opacity: 0.5;
      }

      /* Mark the active step: */
      .step.active {
          opacity: 1;
      }

      /* Mark the steps that are finished and valid: */
      .step.finish {
          background-color: #4CAF50;
      }
  </style>
  <!------------------SCRIPT---------------------------->

  <script>
      const CATALOG ={
        PICCPerfect: ["https://mighty-well.com/products/picc-line-cover-piccperfect-mighty-well?_pos=5&_sid=db99fc554&_ss=r", "https://blog.mighty-well.com/2017/07/adapting-to-the-picc-life/"],
        MedPlanner:  ["https://mighty-well.com/collections/all/products/mighty-medplanner-medical-organizer","https://blog.mighty-well.com/2019/06/trying-out-the-mighty-medplanner-your-new-medical-organizer/"],
        MightyPack: ["https://mighty-well.com/collections/all/products/medical-iv-infusion-backpack-for-patients","https://blog.mighty-well.com/2018/12/travel-without-worries-with-the-mighty-pack-the-best-backpack-for-friends-in-the-fight/"],
        MightyWrap: ["https://mighty-well.com/collections/all/products/the-mighty-jacket","https://blog.mighty-well.com/2017/06/learning-to-love-your-tube/"],
        UndefeatedWear:["https://mighty-well.com/collections/all/products/undefeated-t-shirt-heather-gray","https://blog.mighty-well.com/2019/11/mighty-well-fall-photoshoot/"]
      }
      var currentTab = 0; // Current tab is set to be the first tab (0)
      showTab(currentTab); // Display the current tab

      function showTab(n) {
          // This function will display the specified tab of the form ...
          var x = document.getElementsByClassName("tab");
          x[n].style.display = "block";
          // ... and fix the Previous/Next buttons:
          if(n == x.length-1){
            document.getElementById("prevBtn").style.display = "none";
            document.getElementById("nextBtn").style.display = "none";
          }
          else{
          if (n == 0) {
              document.getElementById("prevBtn").style.display = "none";
          } else {
              document.getElementById("prevBtn").style.display = "inline";
          }
          if (n == (x.length - 2)) {
              document.getElementById("nextBtn").innerHTML = "Get Results!";
          } else {
              document.getElementById("nextBtn").innerHTML = "Next";
          }}
          // ... and run a function that displays the correct step indicator:
          fixStepIndicator(n)
      }

      function nextPrev(n) {
          // This function will figure out which tab to display
          var x = document.getElementsByClassName("tab");
          // Exit the function if any field in the current tab is invalid:
          if (n == 1 && !validateForm()) return false;
          // Hide the current tab:
          x[currentTab].style.display = "none";
          // Increase or decrease the current tab by 1:
          currentTab = currentTab + n;
          // if you have reached the end of the form... :
          if (currentTab >= x.length) {
              //...the form gets submitted:
              document.getElementById("demo").innerHTML = "check";
              document.getElementById("nextBtn").onclick = function() {calculateProduct();}
              /*INSERT CODE TO USE PRODUCT REC FUNCTION*/
              calculateProduct()

              //document.getElementById("survey-form").submit();
              return false;
          }
          // Otherwise, display the correct tab:
          showTab(currentTab);
      }

      function validateForm() {
          // This function deals with validation of the form fields
          var x, y, i, valid = true;
          x = document.getElementsByClassName("tab");
          y = x[currentTab].getElementsByTagName("input");
          // A loop that checks every input field in the current tab:
          for (i = 0; i < y.length; i++) {
              // If a field is empty...
              if (y[i].value == "") {
                  // add an "invalid" class to the field:
                  y[i].className += " invalid";
                  // and set the current valid status to false:
                  valid = false;
              }
          }
          // If the valid status is true, mark the step as finished and valid:
          if (valid) {
              document.getElementsByClassName("step")[currentTab].className += " finish";
          }
          return valid; // return the valid status
      }

      function fixStepIndicator(n) {
          // This function removes the "active" class of all steps...
          var i, x = document.getElementsByClassName("step");
          for (i = 0; i < x.length+1; i++) {
              x[i].className = x[i].className.replace(" active", "");
          }
          //... and adds the "active" class to the current step:
          x[n].className += " active";
      }

      function calculateProduct() {
          var deviceChecks = document.getElementsByName("meddev");
          var deviceUsed;
          for (i = 0; i < deviceChecks.length; i++) {
              // If a field is empty...
              if (deviceChecks[i].checked) {
                  deviceUsed = deviceChecks[i].value;
                  console.log("Device used:" + deviceUsed);
                  document.getElementById("demo").innerHTML = "Device used: " + deviceUsed;
              }
          }

          // https://api.jsonbin.io/b/5eb23bd48284f36af7b645fc
          let req = new XMLHttpRequest();

          req.onreadystatechange = () => {
              if (req.readyState == XMLHttpRequest.DONE) {
                  var jsonData = JSON.parse(req.responseText);
                  console.log("Recommended devices: "+ jsonData[deviceUsed])
                  console.log("All jSON Data: " + req.responseText);
              }
          };

          req.open("GET", "https://api.jsonbin.io/b/5eb23bd48284f36af7b645fc/1", true);
          req.send();
      }
      /* function productRecOut(){
        let recProduct = CATALOG[//insert function]
        let productName =recProduct[0]
        let productPicture =recProduct[0]
        let blogName = recProduct[1]
        let blogPicture = recProduct[1]
        document.querySelectorAll("productLink").setAttribute("href". recProduct[0]);
        document.getElementById("productName").innerText = productName;
        document.getElementById("productPicture").setAttribute("src", productPicture);
      }*/
  </script>

</form>
